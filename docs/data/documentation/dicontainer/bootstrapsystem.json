{"sections":[],"hierarchy":{"paths":[["doc:\/\/DiContainer\/documentation\/DiContainer"]]},"schemaVersion":{"minor":3,"patch":0,"major":0},"identifier":{"url":"doc:\/\/DiContainer\/documentation\/DiContainer\/BootstrapSystem","interfaceLanguage":"swift"},"primaryContentSections":[{"kind":"content","content":[{"type":"heading","text":"🎯 왜 Bootstrap이 필요한가?","anchor":"%F0%9F%8E%AF-%EC%99%9C-Bootstrap%EC%9D%B4-%ED%95%84%EC%9A%94%ED%95%9C%EA%B0%80","level":2},{"type":"heading","text":"1. 앱 생명주기와의 일치","anchor":"1-%EC%95%B1-%EC%83%9D%EB%AA%85%EC%A3%BC%EA%B8%B0%EC%99%80%EC%9D%98-%EC%9D%BC%EC%B9%98","level":3},{"type":"codeListing","syntax":"swift","code":["\/\/ ❌ 잘못된 접근: 언제 초기화되는지 불분명","DI.register(UserService.self) { UserServiceImpl() }  \/\/ 언제 호출되는지?","","\/\/ ✅ 올바른 접근: 명확한 초기화 시점","await DependencyContainer.bootstrap { container in","    container.register(UserService.self) { UserServiceImpl() }","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Bootstrap은 앱이 시작될 때 "},{"type":"strong","inlineContent":[{"text":"한 번만","type":"text"}]},{"type":"text","text":" 실행되어 모든 의존성을 초기화합니다."},{"type":"text","text":" "},{"type":"text","text":"이는 앱의 생명주기와 정확히 일치하여 예측 가능한 동작을 보장합니다."}]},{"type":"heading","text":"2. Swift Concurrency와의 완벽한 통합","anchor":"2-Swift-Concurrency%EC%99%80%EC%9D%98-%EC%99%84%EB%B2%BD%ED%95%9C-%ED%86%B5%ED%95%A9","level":3},{"type":"codeListing","syntax":"swift","code":["\/\/ Modern Swift Concurrency 패턴","@main","struct MyApp: App {","    init() {","        Task {","            await DependencyContainer.bootstrap { container in","                \/\/ 동기 의존성들","                container.register(UserService.self) { UserServiceImpl() }","                container.register(DatabaseService.self) { DatabaseServiceImpl() }","            }","        }","    }","}"]},{"type":"heading","text":"3. Actor Hop 최적화","anchor":"3-Actor-Hop-%EC%B5%9C%EC%A0%81%ED%99%94","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"Bootstrap 시스템은 Actor 간 전환을 최소화하여 성능을 극대화합니다:"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"배치 처리"}],"type":"strong"},{"text":": 모든 등록을 한 번에 처리하여 actor hop 횟수 감소","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"스냅샷 기반"}]},{"type":"text","text":": 내부 컨테이너를 한 번에 생성하고 "},{"type":"codeVoice","code":"live"},{"type":"text","text":"로 복사"}]}]},{"content":[{"inlineContent":[{"inlineContent":[{"text":"비동기 안전","type":"text"}],"type":"strong"},{"text":": Actor 경계를 명확히 하여 데이터 경쟁 방지","type":"text"}],"type":"paragraph"}]}]},{"type":"heading","text":"🏗️ Bootstrap 아키텍처","anchor":"%F0%9F%8F%97%EF%B8%8F-Bootstrap-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98","level":2},{"type":"heading","text":"Core Components","anchor":"Core-Components","level":3},{"type":"codeListing","syntax":null,"code":["┌─────────────────────────────────────────┐","│             Bootstrap Actor             │","├─────────────────────────────────────────┤","│ • 상태 관리 (didBootstrap)              │","│ • 컨테이너 생성\/교체                    │","│ • 중복 방지 (이미 bootstrap된 경우)     │","│ • 에러 처리 및 복구                     │","└─────────────────────────────────────────┘","                   ↓","┌─────────────────────────────────────────┐","│           Live Container                │","├─────────────────────────────────────────┤","│ • 실제 사용되는 컨테이너                │","│ • 메인 스레드에서 접근 가능             │","│ • Bootstrap 완료 후 교체                │","└─────────────────────────────────────────┘"]},{"type":"heading","text":"3가지 Bootstrap 방식","anchor":"3%EA%B0%80%EC%A7%80-Bootstrap-%EB%B0%A9%EC%8B%9D","level":3},{"type":"heading","text":"1. 동기 Bootstrap (권장)","anchor":"1-%EB%8F%99%EA%B8%B0-Bootstrap-%EA%B6%8C%EC%9E%A5","level":4},{"type":"codeListing","syntax":"swift","code":["await DependencyContainer.bootstrap { container in","    container.register(UserService.self) { UserServiceImpl() }","    container.register(NetworkService.self) { NetworkServiceImpl() }","}"]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"대부분의 경우에 적합","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"빠른 실행 속도","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"간단한 설정","type":"text"}],"type":"paragraph"}]}]},{"type":"heading","text":"2. 비동기 Bootstrap (무거운 초기화)","anchor":"2-%EB%B9%84%EB%8F%99%EA%B8%B0-Bootstrap-%EB%AC%B4%EA%B1%B0%EC%9A%B4-%EC%B4%88%EA%B8%B0%ED%99%94","level":4},{"type":"codeListing","syntax":"swift","code":["let success = await DependencyContainer.bootstrapAsync { container in","    \/\/ 비동기 초기화가 필요한 경우","    let dbService = try await DatabaseService.initialize()","    container.register(DatabaseService.self) { dbService }","}"]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"네트워크 요청이 필요한 경우","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"파일 시스템 초기화"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"외부 SDK 초기화"}],"type":"paragraph"}]}]},{"type":"heading","text":"3. 혼합 Bootstrap (최적화)","anchor":"3-%ED%98%BC%ED%95%A9-Bootstrap-%EC%B5%9C%EC%A0%81%ED%99%94","level":4},{"type":"codeListing","syntax":"swift","code":["await DependencyContainer.bootstrapMixed(","    sync: { container in","        \/\/ 빠른 동기 의존성들","        container.register(UserService.self) { UserServiceImpl() }","    },","    async: { container in","        \/\/ 느린 비동기 의존성들","        let apiClient = try await APIClient.configure()","        container.register(APIClient.self) { apiClient }","    }",")"]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"성능 최적화가 중요한 경우","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"동기\/비동기 의존성 분리","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"단계별 초기화"}]}]}]},{"type":"heading","text":"💡 Best Practices","anchor":"%F0%9F%92%A1-Best-Practices","level":2},{"type":"heading","text":"✅ DO - 권장 사항","anchor":"%E2%9C%85-DO-%EA%B6%8C%EC%9E%A5-%EC%82%AC%ED%95%AD","level":3},{"type":"heading","text":"1. 앱 시작 시 한 번만 Bootstrap","anchor":"1-%EC%95%B1-%EC%8B%9C%EC%9E%91-%EC%8B%9C-%ED%95%9C-%EB%B2%88%EB%A7%8C-Bootstrap","level":4},{"type":"codeListing","syntax":"swift","code":["@main","struct MyApp: App {","    init() {","        Task {","            await setupDependencies()","        }","    }","","    private func setupDependencies() async {","        await DependencyContainer.bootstrap { container in","            \/\/ 모든 의존성을 여기서 등록","            AppDIContainer.registerAll(to: container)","        }","    }","}"]},{"type":"heading","text":"2. 의존성 그룹별 모듈화","anchor":"2-%EC%9D%98%EC%A1%B4%EC%84%B1-%EA%B7%B8%EB%A3%B9%EB%B3%84-%EB%AA%A8%EB%93%88%ED%99%94","level":4},{"type":"codeListing","syntax":"swift","code":["enum AppModules {","    static func registerNetworking(to container: DependencyContainer) {","        container.register(APIClient.self) { APIClientImpl() }","        container.register(NetworkService.self) { NetworkServiceImpl() }","    }","","    static func registerDatabase(to container: DependencyContainer) {","        container.register(DatabaseService.self) { DatabaseServiceImpl() }","        container.register(CacheService.self) { CacheServiceImpl() }","    }","}","","\/\/ Bootstrap에서 사용","await DependencyContainer.bootstrap { container in","    AppModules.registerNetworking(to: container)","    AppModules.registerDatabase(to: container)","}"]},{"type":"heading","text":"3. 환경별 조건부 등록","anchor":"3-%ED%99%98%EA%B2%BD%EB%B3%84-%EC%A1%B0%EA%B1%B4%EB%B6%80-%EB%93%B1%EB%A1%9D","level":4},{"type":"codeListing","syntax":"swift","code":["await DependencyContainer.bootstrap { container in","    #if DEBUG","    container.register(APIClient.self) { MockAPIClient() }","    #else","    container.register(APIClient.self) { ProductionAPIClient() }","    #endif","}"]},{"type":"heading","text":"❌ DON’T - 피해야 할 패턴","anchor":"%E2%9D%8C-DONT-%ED%94%BC%ED%95%B4%EC%95%BC-%ED%95%A0-%ED%8C%A8%ED%84%B4","level":3},{"type":"heading","text":"1. 여러 번 Bootstrap 호출","anchor":"1-%EC%97%AC%EB%9F%AC-%EB%B2%88-Bootstrap-%ED%98%B8%EC%B6%9C","level":4},{"type":"codeListing","syntax":"swift","code":["\/\/ ❌ 잘못된 패턴","await DependencyContainer.bootstrap { container in","    container.register(UserService.self) { UserServiceImpl() }","}","","\/\/ 나중에 또 호출... (무시됨)","await DependencyContainer.bootstrap { container in","    container.register(NetworkService.self) { NetworkServiceImpl() }","}"]},{"type":"heading","text":"2. Bootstrap 없이 DI 사용","anchor":"2-Bootstrap-%EC%97%86%EC%9D%B4-DI-%EC%82%AC%EC%9A%A9","level":4},{"type":"codeListing","syntax":"swift","code":["\/\/ ❌ Bootstrap 전에 접근하면 에러!","let userService: UserService = DI.requireResolve(UserService.self)"]},{"type":"heading","text":"3. 런타임에 새로운 의존성 추가","anchor":"3-%EB%9F%B0%ED%83%80%EC%9E%84%EC%97%90-%EC%83%88%EB%A1%9C%EC%9A%B4-%EC%9D%98%EC%A1%B4%EC%84%B1-%EC%B6%94%EA%B0%80","level":4},{"type":"codeListing","syntax":"swift","code":["\/\/ ❌ Bootstrap 이후 추가 등록은 권장하지 않음","DI.register(NewService.self) { NewServiceImpl() }"]},{"type":"heading","text":"🔧 고급 기능","anchor":"%F0%9F%94%A7-%EA%B3%A0%EA%B8%89-%EA%B8%B0%EB%8A%A5","level":2},{"type":"heading","text":"1. Bootstrap 상태 확인","anchor":"1-Bootstrap-%EC%83%81%ED%83%9C-%ED%99%95%EC%9D%B8","level":3},{"type":"codeListing","syntax":"swift","code":["let isReady = await DependencyContainer.isBootstrapped","if isReady {","    \/\/ 안전하게 DI 사용 가능","    let service = DI.resolve(UserService.self)","}"]},{"type":"heading","text":"2. Bootstrap 실패 처리","anchor":"2-Bootstrap-%EC%8B%A4%ED%8C%A8-%EC%B2%98%EB%A6%AC","level":3},{"type":"codeListing","syntax":"swift","code":["do {","    let success = await DependencyContainer.bootstrapAsync { container in","        let service = try await ExternalService.initialize()","        container.register(ExternalService.self) { service }","    }","","    if !success {","        \/\/ Fallback 처리","        print(\"Bootstrap failed, using fallback configuration\")","    }","} catch {","    fatalError(\"Critical bootstrap error: \\(error)\")","}"]},{"type":"heading","text":"3. 테스트에서 Bootstrap 재설정","anchor":"3-%ED%85%8C%EC%8A%A4%ED%8A%B8%EC%97%90%EC%84%9C-Bootstrap-%EC%9E%AC%EC%84%A4%EC%A0%95","level":3},{"type":"codeListing","syntax":"swift","code":["class DITests: XCTestCase {","    override func setUp() async throws {","        await DependencyContainer.releaseAll()  \/\/ 기존 상태 정리","","        await DependencyContainer.bootstrap { container in","            \/\/ 테스트용 Mock 등록","            container.register(UserService.self) { MockUserService() }","        }","    }","}"]},{"type":"heading","text":"📊 성능 특징","anchor":"%F0%9F%93%8A-%EC%84%B1%EB%8A%A5-%ED%8A%B9%EC%A7%95","level":2},{"type":"heading","text":"Bootstrap 성능 측정 결과","anchor":"Bootstrap-%EC%84%B1%EB%8A%A5-%EC%B8%A1%EC%A0%95-%EA%B2%B0%EA%B3%BC","level":3},{"type":"table","header":"row","rows":[[[{"type":"paragraph","inlineContent":[{"text":"의존성 개수","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"동기 Bootstrap"}]}],[{"type":"paragraph","inlineContent":[{"text":"비동기 Bootstrap","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"혼합 Bootstrap"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"10개","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"~1ms","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"text":"~3ms","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"~2ms"}]}]],[[{"type":"paragraph","inlineContent":[{"text":"50개","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"~5ms"}]}],[{"type":"paragraph","inlineContent":[{"text":"~15ms","type":"text"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"~8ms"}]}]],[[{"type":"paragraph","inlineContent":[{"type":"text","text":"100개"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"~10ms"}]}],[{"type":"paragraph","inlineContent":[{"type":"text","text":"~25ms"}]}],[{"type":"paragraph","inlineContent":[{"text":"~15ms","type":"text"}]}]]]},{"type":"heading","text":"Actor Hop 최적화","anchor":"Actor-Hop-%EC%B5%9C%EC%A0%81%ED%99%94","level":3},{"type":"codeListing","syntax":null,"code":["기존 방식: 등록마다 Actor Hop 발생","Register1 -> Actor Hop -> Register2 -> Actor Hop -> Register3...","","Bootstrap 방식: 배치 처리로 Actor Hop 최소화","[Register1, Register2, Register3...] -> Single Actor Hop -> Complete"]},{"type":"heading","text":"🎯 결론","anchor":"%F0%9F%8E%AF-%EA%B2%B0%EB%A1%A0","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"Bootstrap 시스템은 DiContainer의 핵심 설계 철학을 반영합니다:"}]},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"inlineContent":[{"type":"text","text":"예측 가능성"}],"type":"strong"},{"text":": 앱 시작 시 한 번의 명확한 초기화","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"성능 최적화","type":"text"}]},{"type":"text","text":": Actor Hop 최소화와 배치 처리"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Swift Concurrency 통합"}]},{"type":"text","text":": Modern Swift 패턴과의 완벽한 호환"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"안전성"}]},{"type":"text","text":": 중복 방지와 에러 처리"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"확장성"}]},{"type":"text","text":": 다양한 초기화 패턴 지원"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"text":"이러한 이유로 Bootstrap은 단순한 편의 기능이 아닌, ","type":"text"},{"inlineContent":[{"type":"text","text":"DiContainer 아키텍처의 필수 구성 요소"}],"type":"strong"},{"text":"입니다.","type":"text"}]},{"type":"heading","text":"핵심 이점","anchor":"%ED%95%B5%EC%8B%AC-%EC%9D%B4%EC%A0%90","level":2},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"앱 생명주기와의 완벽한 일치","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Swift Concurrency 패턴 준수"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Actor Hop 최적화를 통한 성능 향상"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"예측 가능한 초기화 시점","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"중복 방지 및 안전한 상태 관리","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"동기\/비동기 의존성 지원","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"테스트 환경에서의 유연한 재설정"}]}]}]},{"type":"heading","text":"일반적인 안티패턴","anchor":"%EC%9D%BC%EB%B0%98%EC%A0%81%EC%9D%B8-%EC%95%88%ED%8B%B0%ED%8C%A8%ED%84%B4","level":2},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Bootstrap 없이 DI 사용 시도","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"여러 번의 Bootstrap 호출"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Bootstrap 이후 런타임 의존성 추가"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Bootstrap 완료 확인 없이 의존성 접근"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"테스트에서 Bootstrap 상태 정리 누락","type":"text"}],"type":"paragraph"}]}]},{"type":"heading","text":"권장 설정 패턴","anchor":"%EA%B6%8C%EC%9E%A5-%EC%84%A4%EC%A0%95-%ED%8C%A8%ED%84%B4","level":2},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"앱 시작 시점에서 단일 Bootstrap 호출","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"모듈별 의존성 그룹화 및 등록"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"환경별 조건부 의존성 등록","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Bootstrap 상태 확인 후 DI 사용"}]}]},{"content":[{"inlineContent":[{"text":"테스트에서 깨끗한 상태로 재설정","type":"text"}],"type":"paragraph"}]}]}]}],"kind":"article","metadata":{"roleHeading":"Article","modules":[{"name":"DiContainer"}],"title":"DiContainer Bootstrap 시스템 - 설계 근거 및 사용법","role":"article"},"variants":[{"paths":["\/documentation\/dicontainer\/bootstrapsystem"],"traits":[{"interfaceLanguage":"swift"}]}],"references":{"doc://DiContainer/documentation/DiContainer":{"title":"DiContainer","kind":"symbol","url":"\/documentation\/dicontainer","role":"collection","type":"topic","abstract":[{"text":"A modern, high-performance dependency injection framework designed for Swift Concurrency and Actor models.","type":"text"}],"identifier":"doc:\/\/DiContainer\/documentation\/DiContainer"}}}